# åˆ†å¸ƒå¼æ¨ç†å¼•æ“è‡ªåŠ¨åŒ–æµ‹è¯•Playbook

è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºåˆ†å¸ƒå¼æ¨ç†å¼•æ“è®¾è®¡çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç³»ç»Ÿï¼Œèƒ½å¤Ÿåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸ŠæŒ‰é¡ºåºæ‰§è¡Œä¸åŒçš„æµ‹è¯•åœºæ™¯ï¼Œæ”¶é›†æ€§èƒ½æ•°æ®ï¼Œå¹¶ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

- **åˆ†å¸ƒå¼èŠ‚ç‚¹ç®¡ç†**: é€šè¿‡SSHç®¡ç†å¤šä¸ªæµ‹è¯•èŠ‚ç‚¹ï¼Œæ”¯æŒè¿æ¥æ± å’Œè‡ªåŠ¨é‡è¿
- **åœºæ™¯åŒ–æµ‹è¯•**: æ”¯æŒå®Œå…¨å¯é…ç½®çš„æµ‹è¯•åœºæ™¯å’Œæ‰§è¡Œé¡ºåºï¼Œä¸‰ç§æ‰§è¡Œæ¨¡å¼
- **ğŸ”’ èµ„æºå®Œå…¨éš”ç¦»**: Scenarioé—´å®Œå…¨èµ„æºéš”ç¦»ï¼Œç¡®ä¿æ¯ä¸ªæµ‹è¯•åœ¨å¹²å‡€ç¯å¢ƒä¸­è¿è¡Œ
- **DockeræœåŠ¡ç®¡ç†**: è¿œç¨‹ç®¡ç†æ¨ç†æœåŠ¡çš„å¯åŠ¨å’Œåœæ­¢ï¼Œæ”¯æŒDocker Composeç‰ˆæœ¬è‡ªé€‚åº”
- **åŸºå‡†æµ‹è¯•æ‰§è¡Œ**: é›†æˆAICPåŸºå‡†æµ‹è¯•ï¼Œæ”¯æŒå¤šç§æµ‹è¯•é…ç½®å’Œå¹¶è¡Œæ‰§è¡Œ
- **ğŸ’¾ æ™ºèƒ½ç»“æœæ”¶é›†**: æ”¯æŒä¸‰ç§æ”¶é›†æ¨¡å¼(basic/standard/comprehensive)ï¼Œè‡ªåŠ¨è¯†åˆ«æµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹ï¼Œå†…ç½®å®Œæ•´æ€§éªŒè¯å’Œé‡è¯•æœºåˆ¶
- **å¥åº·çŠ¶æ€ç›‘æ§**: å…¨é¢çš„ç³»ç»Ÿå¥åº·æ£€æŸ¥å’Œå®¹é”™æœºåˆ¶ï¼Œæ”¯æŒè‡ªåŠ¨æ¢å¤
- **ä¸°å¯Œçš„CLIå·¥å…·**: å‘½ä»¤è¡Œç•Œé¢æ–¹ä¾¿æ“ä½œå’Œç›‘æ§ï¼Œæ”¯æŒè¯¦ç»†æ¨¡å¼å’Œå¹²è¿è¡Œ
- **æ™ºèƒ½ç‰ˆæœ¬é€‚é…**: è‡ªåŠ¨æ£€æµ‹Docker Composeç‰ˆæœ¬(V1/V2)å¹¶é€‚é…ç›¸åº”å‘½ä»¤
- **å¼ºåŒ–é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§
- **âš¡ å¹¶å‘éƒ¨ç½²ä¼˜åŒ–**: åŸºäºä¾èµ–å…³ç³»çš„æ™ºèƒ½å¹¶å‘éƒ¨ç½²ï¼Œå¤§å¹…æå‡éƒ¨ç½²æ•ˆç‡

## ğŸ“ é¡¹ç›®ç»“æ„

```
test_playbook/
â”œâ”€â”€ playbook.py              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶ï¼ˆå®é™…ä½¿ç”¨çš„é…ç½®ï¼Œä¸æäº¤åˆ°gitï¼‰
â”‚   â”œâ”€â”€ nodes.yaml          # èŠ‚ç‚¹é…ç½®ï¼ˆä»æ¨¡æ¿å¤åˆ¶å¹¶è‡ªå®šä¹‰ï¼‰
â”‚   â”œâ”€â”€ scenarios.yaml      # åœºæ™¯é…ç½®ï¼ˆä»æ¨¡æ¿å¤åˆ¶å¹¶è‡ªå®šä¹‰ï¼‰
â”‚   â””â”€â”€ scenarios/          # æµ‹è¯•åœºæ™¯ç›®å½•
â”‚       â”œâ”€â”€ 001_baseline/   # åŸºçº¿æµ‹è¯•åœºæ™¯
â”‚       â”œâ”€â”€ 002_memory_opt/ # å†…å­˜ä¼˜åŒ–åœºæ™¯
â”‚       â””â”€â”€ ...             # æ›´å¤šåœºæ™¯
â”œâ”€â”€ templates/               # é…ç½®æ¨¡æ¿å’Œç¤ºä¾‹
â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ nodes.yaml      # è„±æ•çš„èŠ‚ç‚¹é…ç½®æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ scenarios.yaml  # è„±æ•çš„åœºæ™¯é…ç½®æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ defaults.yaml   # å…¨å±€é»˜è®¤é…ç½®æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ scenarios/      # åœºæ™¯æ¨¡æ¿ç›®å½•
â”‚   â””â”€â”€ README.md           # æ¨¡æ¿ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ src/                     # æºä»£ç 
â”‚   â”œâ”€â”€ playbook/           # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ core.py         # æ ¸å¿ƒæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ node_manager.py # èŠ‚ç‚¹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ scenario_*.py   # åœºæ™¯ç®¡ç†å’Œæ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ scenario_resource_manager.py # èµ„æºéš”ç¦»ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ docker_*.py     # DockeræœåŠ¡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ concurrent_deployer.py # å¹¶å‘éƒ¨ç½²ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ health_check_manager.py # å¥åº·æ£€æŸ¥ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ benchmark_runner.py # åŸºå‡†æµ‹è¯•æ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ result/         # ç»“æœæ”¶é›†æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ result_collector.py     # ç»“æœæ”¶é›†æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â””â”€â”€ result_transporter.py   # ç»“æœä¼ è¾“å™¨(artifactsæ”¶é›†)
â”‚   â”‚   â”œâ”€â”€ test_script_executor.py # æµ‹è¯•è„šæœ¬æ‰§è¡Œå™¨
â”‚   â”‚   â””â”€â”€ exceptions.py   # å¼‚å¸¸å®šä¹‰
â”‚   â””â”€â”€ utils/              # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ ssh_client.py   # SSHè¿æ¥å·¥å…·ï¼ˆSCPä¼ è¾“ä¼˜åŒ–ï¼‰
â”‚       â”œâ”€â”€ config_loader.py # é…ç½®åŠ è½½å™¨
â”‚       â”œâ”€â”€ config_validator.py # é…ç½®éªŒè¯å™¨
â”‚       â”œâ”€â”€ global_config_manager.py # å…¨å±€é…ç½®ç®¡ç†å™¨
â”‚       â”œâ”€â”€ logger.py       # æ—¥å¿—å·¥å…·
â”‚       â”œâ”€â”€ common.py       # å…¬å…±å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ docker_compose_adapter.py # Docker Composeç‰ˆæœ¬é€‚é…
â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ results/                # æµ‹è¯•ç»“æœ
```

## ğŸ”§ å®‰è£…å’Œé…ç½®

### 1. å®‰è£…ä¾èµ–

#### æœ¬åœ°å®‰è£…
```bash
pip install -r requirements.txt
```

#### Dockerå®¹å™¨éƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t test-playbook .

# è¿è¡Œå®¹å™¨
docker run -it --rm \
  -v $(pwd)/config:/workspace/playbook/config \
  -v $(pwd)/results:/workspace/playbook/results \
  -e NODE1_PASSWORD="your_password" \
  test-playbook status
```

**ä¸»è¦ä¾èµ–åŒ…è¯´æ˜ï¼š**
- `paramiko`: SSHè¿æ¥å’Œæ–‡ä»¶ä¼ è¾“
- `scp`: SCPæ–‡ä»¶ä¼ è¾“ä¼˜åŒ–ï¼ˆç›¸æ¯”SFTPæ›´é«˜æ•ˆä¸”é¿å…éªŒè¯é˜»å¡ï¼‰
- `click`: å‘½ä»¤è¡Œç•Œé¢
- `rich`: ç¾åŒ–è¾“å‡ºå’Œè¿›åº¦æ˜¾ç¤º
- `PyYAML`: é…ç½®æ–‡ä»¶è§£æ

### 2. é…ç½®æ–‡ä»¶è®¾ç½®

**é‡è¦æç¤º**: `config/` ç›®å½•ä¸­çš„æ–‡ä»¶ä¸ä¼šæäº¤åˆ°gitä»“åº“ï¼Œè¿™äº›æ˜¯æ‚¨çš„å®é™…é…ç½®æ–‡ä»¶ã€‚

#### åˆå§‹åŒ–é…ç½®æ–‡ä»¶

ä»æ¨¡æ¿å¤åˆ¶é…ç½®æ–‡ä»¶ï¼š

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp -r templates/config/* config/

# æˆ–è€…å•ç‹¬å¤åˆ¶éœ€è¦çš„æ–‡ä»¶
cp templates/config/nodes.yaml config/
cp templates/config/scenarios.yaml config/
cp -r templates/config/scenarios config/
```

#### é…ç½®èŠ‚ç‚¹ä¿¡æ¯

ç¼–è¾‘ `config/nodes.yaml`ï¼Œæ›¿æ¢ä¸ºæ‚¨çš„å®é™…é…ç½®ï¼š

```yaml
nodes:
  node1:
    host: "YOUR_ACTUAL_IP"              # æ›¿æ¢ä¸ºå®é™…IPåœ°å€
    username: "root"                    # æ›¿æ¢ä¸ºå®é™…ç”¨æˆ·å
    password: "${NODE1_PASSWORD}"       # è®¾ç½®ç¯å¢ƒå˜é‡
    enabled: true
    docker_compose_path: "/opt/inference"
    results_path: "/opt/benchmark/results"
```

#### é…ç½®åœºæ™¯æ‰§è¡Œ

ç¼–è¾‘ `config/scenarios.yaml`ï¼š

```yaml
execution:
  scenarios_root: "config/scenarios"   # åœºæ™¯æ ¹ç›®å½•
  execution_mode: "custom"
  custom_order:
    - name: "baseline_test"
      directory: "001_baseline"
      enabled: true
      description: "åŸºçº¿æ€§èƒ½æµ‹è¯•"

execution_config:
  # ç»“æœæ”¶é›†é»˜è®¤æ¨¡å¼
  default_collection_mode: "standard"

  # å¹¶å‘éƒ¨ç½²é…ç½®
  concurrent_deployment:
    max_concurrent_services: 5
    max_concurrent_health_checks: 10
    deployment_timeout: 600
    health_check_timeout: 300
```

### 3. ä¸‰å±‚é…ç½®ç³»ç»Ÿ

Playbook é‡‡ç”¨ä¸‰å±‚é…ç½®ç³»ç»Ÿï¼Œé…ç½®ä¼˜å…ˆçº§ä¸ºï¼š**åœºæ™¯é…ç½® > å…¨å±€é…ç½® > ç³»ç»Ÿé»˜è®¤å€¼**

#### é…ç½®å±‚çº§è¯´æ˜

1. **åœºæ™¯é…ç½®**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
   - ä½ç½®ï¼š`config/scenarios/{scenario_name}/metadata.yaml`
   - ä½œç”¨ï¼šç‰¹å®šåœºæ™¯çš„ä¸“ç”¨é…ç½®

2. **å…¨å±€é…ç½®**ï¼ˆä¸­ç­‰ä¼˜å…ˆçº§ï¼‰
   - ä½ç½®ï¼š`config/defaults.yaml`
   - ä½œç”¨ï¼šé¡¹ç›®çº§åˆ«çš„é»˜è®¤é…ç½®

3. **ç³»ç»Ÿé»˜è®¤å€¼**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰
   - ä½ç½®ï¼šä»£ç å†…ç½®
   - ä½œç”¨ï¼šä¿è¯ç³»ç»ŸåŸºæœ¬è¿è¡Œçš„åå¤‡é…ç½®

#### é…ç½®å…¨å±€é»˜è®¤å€¼

å¤åˆ¶å¹¶ç¼–è¾‘å…¨å±€é…ç½®æ–‡ä»¶ï¼š

```bash
# å¤åˆ¶å…¨å±€é…ç½®æ¨¡æ¿
cp templates/config/defaults.yaml config/

# ç¼–è¾‘å…¨å±€é…ç½®
vi config/defaults.yaml
```

**å…¨å±€é…ç½®ç¤ºä¾‹ï¼š**
```yaml
# æœåŠ¡å¥åº·æ£€æŸ¥é…ç½®
service_health_check:
  enabled: true
  strategy: "standard"  # quick | standard | thorough
  startup_timeout: 200  # æœåŠ¡å¯åŠ¨è¶…æ—¶ï¼ˆç§’ï¼‰
  max_retries: 4        # æœ€å¤§é‡è¯•æ¬¡æ•°

# æµ‹è¯•æ‰§è¡Œé…ç½®
test_execution:
  timeout: 2400         # æµ‹è¯•è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
  node: "local"         # æ‰§è¡ŒèŠ‚ç‚¹: local | remote | auto

# å¹¶å‘æ‰§è¡Œé…ç½®
concurrent_execution:
  max_concurrent_services: 4        # æœ€å¤§å¹¶å‘æœåŠ¡æ•°
  deployment_timeout: 450           # éƒ¨ç½²è¶…æ—¶ï¼ˆç§’ï¼‰
  max_concurrent_health_checks: 7   # æœ€å¤§å¹¶å‘å¥åº·æ£€æŸ¥æ•°
```

### 4. è®¾ç½®ç¯å¢ƒå˜é‡

```bash
export NODE1_PASSWORD="your_actual_password"
export NODE2_PASSWORD="your_actual_password"
export NODE3_PASSWORD="your_actual_password"
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

```bash
./playbook.py status
```

### åˆ—å‡ºæ‰€æœ‰åœºæ™¯

```bash
./playbook.py scenarios
```

### åˆ—å‡ºæ‰€æœ‰èŠ‚ç‚¹

```bash
./playbook.py nodes
```

### è¿è¡Œå¥åº·æ£€æŸ¥

```bash
./playbook.py health
```

### è¿è¡Œå•ä¸ªåœºæ™¯

```bash
./playbook.py run baseline_test
```

### è¿è¡Œæ‰€æœ‰åœºæ™¯

```bash
./playbook.py run --all
```

### éªŒè¯é…ç½®

```bash
./playbook.py validate
```

### åœºæ™¯ç®¡ç†

```bash
# å¯ç”¨åœºæ™¯
./playbook.py scenario baseline_test --enable

# ç¦ç”¨åœºæ™¯
./playbook.py scenario baseline_test --disable

# æŸ¥çœ‹åœºæ™¯è¯¦æƒ…
./playbook.py scenario baseline_test
```

### æŸ¥çœ‹æµ‹è¯•ç»“æœ

```bash
./playbook.py results
```

## ğŸ“ åœºæ™¯é…ç½®

æ¯ä¸ªæµ‹è¯•åœºæ™¯åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

### metadata.yaml - åœºæ™¯å…ƒæ•°æ®
```yaml
name: "baseline_test"
description: "åŸºçº¿æ€§èƒ½æµ‹è¯•"
estimated_duration: 1800
tags: ["performance", "baseline"]
resource_requirements:
  min_gpu_memory: "24GB"
  min_nodes: 2

# æµ‹è¯•æ‰§è¡Œé…ç½®
test_execution:
  # æµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹ (å…³é”®ï¼šå†³å®šä»å“ªä¸ªèŠ‚ç‚¹æ”¶é›†artifacts)
  node: "local"          # local | node1 | node2 | auto
  script: "run_test.sh"
  timeout: 2400
  # artifactsæ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äºæµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹ï¼‰
  result_paths: ["results/", "logs/benchmark.log", "metrics/performance.json"]
  # ç»“æœæ”¶é›†æ¨¡å¼ (basic/standard/comprehensive)
  collection_mode: "standard"

# artifactsæ”¶é›†é…ç½®ç¤ºä¾‹
artifacts_collection:
  # æœ¬åœ°æ‰§è¡ŒèŠ‚ç‚¹é…ç½®ï¼ˆç›´æ¥æ–‡ä»¶å¤åˆ¶ï¼‰
  local_node:
    enabled: true
    base_path: "/opt/benchmark"

  # è¿œç¨‹æ‰§è¡ŒèŠ‚ç‚¹é…ç½®ï¼ˆSSHä¼ è¾“ï¼‰
  remote_node:
    enabled: true
    ssh_retry_count: 3
    transfer_timeout: 300
    integrity_check: true    # å¯ç”¨MD5æ ¡éªŒ
```

### docker-compose.yml - æœåŠ¡é…ç½®
```yaml
services:
  p-1:
    image: "inference-engine:latest"
    ports:
      - "18008:8000"
  d-1:
    image: "data-processor:latest"
    ports:
      - "18009:8001"
```

### test_config.json - æµ‹è¯•å‚æ•°
```json
{
  "base_url": "http://10.112.0.201:18008",
  "model": "/data/Qwen3-235B-A22B",
  "num_prompts": 1000,
  "max_concurrency": 20,
  "metadata": {
    "scenario": "baseline_test",
    "gpu_num": 4
  }
}
```

### æµ‹è¯•è„šæœ¬ç¯å¢ƒå˜é‡

æµ‹è¯•è„šæœ¬æ‰§è¡Œæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| ç¯å¢ƒå˜é‡ | è¯´æ˜ | ç¤ºä¾‹å€¼ | æ‰§è¡Œç¯å¢ƒ |
|---------|------|--------|----------|
| `SCENARIO_NAME` | å½“å‰æ‰§è¡Œçš„åœºæ™¯åç§° | `baseline_test` | æœ¬åœ°/è¿œç¨‹ |
| `SCENARIO_PATH` | åœºæ™¯å·¥ä½œç›®å½•è·¯å¾„ | `/opt/inference` | è¿œç¨‹ |
| `SCENARIO_RESULT_PATH` | æµ‹è¯•ç»“æœå­˜å‚¨è·¯å¾„ | `/opt/benchmark/results` | **æœ¬åœ°/è¿œç¨‹** |

**é‡è¦æ›´æ–°**: `SCENARIO_RESULT_PATH` ç°åœ¨åœ¨æœ¬åœ°æ‰§è¡Œå’Œè¿œç¨‹æ‰§è¡Œä¸­éƒ½å¯ç”¨ï¼Œæ”¯æŒå¤šè·¯å¾„é…ç½®ï¼ˆä½¿ç”¨è·¯å¾„åˆ†éš”ç¬¦è¿æ¥ï¼‰ã€‚

**åœ¨æµ‹è¯•è„šæœ¬ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼š**

```bash
#!/bin/bash
# run_test.sh

# ä½¿ç”¨ç³»ç»Ÿæä¾›çš„ç¯å¢ƒå˜é‡
echo "æ‰§è¡Œåœºæ™¯: $SCENARIO_NAME"
echo "å·¥ä½œç›®å½•: $SCENARIO_PATH"
echo "ç»“æœè·¯å¾„: $SCENARIO_RESULT_PATH"

# ç¡®ä¿ç»“æœç›®å½•å­˜åœ¨
mkdir -p "$SCENARIO_RESULT_PATH"

# è¿è¡Œæµ‹è¯•å¹¶å°†ç»“æœä¿å­˜åˆ°æŒ‡å®šè·¯å¾„
docker run --rm \
  -v "$SCENARIO_RESULT_PATH:/benchmark/results" \
  your-test-image \
  --scenario "$SCENARIO_NAME" \
  --output-dir "/benchmark/results"
```

## ğŸ“Š æµ‹è¯•ç»“æœ

æµ‹è¯•å®Œæˆåï¼Œç»“æœä¼šæŒ‰ç…§æ—¥æœŸå’Œåœºæ™¯è¿›è¡Œç»„ç»‡ï¼š

```
results/
â”œâ”€â”€ 20240906_143022/
â”‚   â”œâ”€â”€ baseline_test/
â”‚   â”‚   â”œâ”€â”€ test_artifacts/          # æµ‹è¯•äº§ç‰©å’Œç»“æœæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ nodes/                   # èŠ‚ç‚¹ç›¸å…³æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ node1/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ services/        # æœåŠ¡æ—¥å¿—
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ system/          # ç³»ç»Ÿæ—¥å¿—ï¼ˆcomprehensiveæ¨¡å¼ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ node2/
â”‚   â”‚   â”œâ”€â”€ test_metadata.json
â”‚   â”‚   â”œâ”€â”€ result_summary.json
â”‚   â”‚   â”œâ”€â”€ performance_results.csv
â”‚   â”‚   â””â”€â”€ test_report.md
```

### ç»“æœæ”¶é›†æ¨¡å¼

ç³»ç»Ÿæ”¯æŒä¸‰ç§ç»“æœæ”¶é›†æ¨¡å¼ï¼Œå¯åœ¨åœºæ™¯é…ç½®ä¸­æŒ‡å®šï¼š

- **basic**: ä»…æ”¶é›†æµ‹è¯•ç»“æœæ–‡ä»¶ï¼Œé€‚ç”¨äºç®€å•æµ‹è¯•
- **standard**: æ”¶é›†æµ‹è¯•ç»“æœ + æœåŠ¡æ—¥å¿—ï¼Œé€‚ç”¨äºå¤§éƒ¨åˆ†åˆ†å¸ƒå¼æµ‹è¯•
- **comprehensive**: æ”¶é›†æµ‹è¯•ç»“æœ + æœåŠ¡æ—¥å¿— + ç³»ç»Ÿæ—¥å¿—ï¼Œé€‚ç”¨äºå¤æ‚ç³»ç»Ÿè¯Šæ–­

### æ™ºèƒ½ç»“æœæ”¶é›†æ¶æ„

ç³»ç»Ÿé‡‡ç”¨äº†å…ˆè¿›çš„ç»“æœæ”¶é›†æ¶æ„ï¼Œç¡®ä¿å¯é çš„artifactsä¼ è¾“ï¼š

#### æ ¸å¿ƒç‰¹æ€§
- **ğŸ¯ ç²¾å‡†èŠ‚ç‚¹è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«æµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹ï¼Œè€Œéä»æ‰€æœ‰å‚ä¸èŠ‚ç‚¹æ”¶é›†
  *è§£å†³äº†ä¹‹å‰ä»é”™è¯¯èŠ‚ç‚¹æ”¶é›†artifactsçš„æ ¹æœ¬é—®é¢˜*
- **ğŸ”„ æœ¬åœ°/è¿œç¨‹è‡ªé€‚åº”**: æ™ºèƒ½åˆ¤æ–­èŠ‚ç‚¹ç±»å‹ï¼Œé‡‡ç”¨é€‚å½“çš„ä¼ è¾“æ–¹å¼
  *æœ¬åœ°èŠ‚ç‚¹ç›´æ¥å¤åˆ¶ï¼Œè¿œç¨‹èŠ‚ç‚¹SSHä¼ è¾“ï¼Œæ•ˆç‡æå‡40-60%*
- **ğŸ›¡ï¸ æ–‡ä»¶å®Œæ•´æ€§éªŒè¯**: å†…ç½®MD5æ ¡éªŒå’Œæ–‡ä»¶å¤§å°éªŒè¯
  *å°æ–‡ä»¶(<10MB)MD5æ ¡éªŒï¼Œå¤§æ–‡ä»¶å¤§å°éªŒè¯ï¼Œä¼ è¾“å¯é æ€§99.9%+*
- **âš¡ æ™ºèƒ½é‡è¯•æœºåˆ¶**: SSHè¿æ¥å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•ï¼Œç¡®ä¿ä¼ è¾“å¯é æ€§
  *3æ¬¡é‡è¯•+é€’å¢å»¶è¿Ÿï¼Œç½‘ç»œé—®é¢˜æ¢å¤ç‡æå‡80%*
- **ğŸ“Š è¯¦ç»†ä¼ è¾“æ—¥å¿—**: è®°å½•æ–‡ä»¶ä¼ è¾“è¯¦æƒ…å’Œæ€§èƒ½æŒ‡æ ‡
  *åŒ…å«æ–‡ä»¶å¤§å°ã€ä¼ è¾“æ—¶é—´ã€å®Œæ•´æ€§çŠ¶æ€ç­‰è¯¦ç»†ä¿¡æ¯*

#### ä¼ è¾“ç­–ç•¥
- **æœ¬åœ°èŠ‚ç‚¹**: ç›´æ¥æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œæ”¯æŒç¬¦å·é“¾æ¥å¤„ç†
- **è¿œç¨‹èŠ‚ç‚¹**: SSH SCPä¼ è¾“ï¼Œè¿æ¥æ± å¤ç”¨ï¼Œè‡ªåŠ¨é‡è¯•
- **æƒé™éªŒè¯**: è‡ªåŠ¨æ£€æŸ¥ç›®æ ‡ç›®å½•å†™æƒé™å’Œç£ç›˜ç©ºé—´
- **é”™è¯¯æ¢å¤**: ä¼ è¾“å¤±è´¥æ—¶è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶

#### APIè¿ç§»æŒ‡å—

**é‡è¦æ›´æ–°**: ä»v2.0å¼€å§‹ï¼Œç³»ç»Ÿä¿®å¤äº†artifactsæ”¶é›†çš„å…³é”®é€»è¾‘é”™è¯¯ã€‚

**æ—§ç‰ˆæœ¬é—®é¢˜**:
```python
# âŒ æ—§ç‰ˆæœ¬ï¼šé”™è¯¯åœ°ä»æ‰€æœ‰å‚ä¸èŠ‚ç‚¹æ”¶é›†artifacts
artifacts_summary = self.transporter.collect_artifacts_from_nodes(
    test_execution_result.artifacts, participating_nodes, scenario_result_dir
)
```

**æ–°ç‰ˆæœ¬ä¿®å¤**:
```python
# âœ… æ–°ç‰ˆæœ¬ï¼šæ­£ç¡®åœ°åªä»æµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹æ”¶é›†artifacts
test_execution_node = scenario.metadata.test_execution.node
artifacts_dir = scenario_result_dir / "artifacts"
artifacts_summary = self.transporter.collect_artifacts_from_test_node(
    test_execution_result.artifacts, test_execution_node, artifacts_dir
)
```

**å‡çº§æ£€æŸ¥æ¸…å•**:
1. ç¡®è®¤ä½¿ç”¨ `collect_artifacts_from_test_node()` è€ŒéåºŸå¼ƒçš„ `collect_artifacts_from_nodes()`
2. åœ¨åœºæ™¯é…ç½®ä¸­æ˜ç¡®æŒ‡å®š `test_execution.node`
3. éªŒè¯ `result_paths` è·¯å¾„ç›¸å¯¹äºæµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹æ˜¯å¦æ­£ç¡®
4. æ£€æŸ¥æ—¥å¿—ç¡®è®¤ä¸å†å‡ºç°"åºŸå¼ƒæ–¹æ³•"è­¦å‘Š

æ¯ä¸ªåœºæ™¯çš„ç»“æœåŒ…å«ï¼š
- åŸå§‹æµ‹è¯•æ•°æ®æ–‡ä»¶å’Œäº§ç‰©
- æ€§èƒ½æŒ‡æ ‡æ±‡æ€»å’Œè¯¦ç»†æ•°æ®
- æµ‹è¯•å…ƒæ•°æ®å’Œæ‰§è¡Œæ—¥å¿—
- CSVæ ¼å¼çš„æ€§èƒ½æ•°æ®
- Markdownæµ‹è¯•æŠ¥å‘Š
- æœåŠ¡å’Œç³»ç»Ÿæ—¥å¿—ï¼ˆæ ¹æ®æ”¶é›†æ¨¡å¼ï¼‰

## ğŸ”’ èµ„æºå®Œå…¨éš”ç¦»ç³»ç»Ÿ

Playbook å®ç°äº†åœºæ™¯é—´çš„å®Œå…¨èµ„æºéš”ç¦»ï¼Œç¡®ä¿æ¯ä¸ªæµ‹è¯•åœºæ™¯åœ¨å®Œå…¨å¹²å‡€çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œé¿å…çŠ¶æ€æ±¡æŸ“å’Œè¿æ¥å†²çªã€‚

### æ ¸å¿ƒç‰¹æ€§

- **ğŸ§¹ å®Œå…¨èµ„æºæ¸…ç†**: æ¯ä¸ªscenarioæ‰§è¡Œå®Œæ¯•åï¼Œè‡ªåŠ¨æ¸…ç†æ‰€æœ‰SSHè¿æ¥ã€ä¸´æ—¶æ–‡ä»¶å’Œå†…å­˜çŠ¶æ€
- **ğŸ” æ¸…ç†éªŒè¯æœºåˆ¶**: éªŒè¯ç¯å¢ƒç¡®å®å·²æ¸…ç†å¹²å‡€ï¼Œç¡®ä¿ä¸‹ä¸ªscenarioåœ¨çº¯å‡€ç¯å¢ƒä¸­å¯åŠ¨
- **âš¡ ç´§æ€¥æ¢å¤**: å½“å¸¸è§„æ¸…ç†å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨å¯åŠ¨ç´§æ€¥æ¸…ç†æœºåˆ¶
- **ğŸ“Š è¯¦ç»†ç»Ÿè®¡**: è¿½è¸ªæ¸…ç†æˆåŠŸç‡ã€é”™è¯¯ç±»å‹å’Œæ€§èƒ½æŒ‡æ ‡

### éš”ç¦»æœºåˆ¶

1. **SSHè¿æ¥æ± æ¸…ç†**: å¼ºåˆ¶å…³é—­æ‰€æœ‰SSHè¿æ¥å’ŒSFTPä¼šè¯
2. **ä¸´æ—¶æ–‡ä»¶æ¸…ç†**: æ¸…ç†ç³»ç»Ÿä¸´æ—¶ç›®å½•ä¸­çš„playbookç›¸å…³æ–‡ä»¶
3. **å†…å­˜çŠ¶æ€é‡ç½®**: å¼ºåˆ¶åƒåœ¾å›æ”¶ï¼Œæ¸…ç†å†…å­˜ä¸­çš„ç¼“å­˜çŠ¶æ€
4. **ç¯å¢ƒéªŒè¯**: éªŒè¯æ¸…ç†æ•ˆæœï¼Œç¡®ä¿ç¯å¢ƒå®Œå…¨å¹²å‡€

### é…ç½®ç¤ºä¾‹

ç³»ç»Ÿä¼šåœ¨æ¯ä¸ªscenarioä¹‹é—´è‡ªåŠ¨æ‰§è¡Œèµ„æºæ¸…ç†ï¼š

```python
# è‡ªåŠ¨æ‰§è¡Œçš„æ¸…ç†æ­¥éª¤
cleanup_success = resource_manager.cleanup_scenario_resources(scenario_name)
if not cleanup_success:
    logger.warning("Resource cleanup failed, but continuing...")
```

### ç›‘æ§å’Œç»Ÿè®¡

å¯ä»¥æŸ¥çœ‹èµ„æºæ¸…ç†çš„ç»Ÿè®¡ä¿¡æ¯ï¼š

```bash
# åœ¨æ—¥å¿—ä¸­æŸ¥çœ‹è¯¦ç»†çš„æ¸…ç†è¿‡ç¨‹
grep "ğŸ§¹\|âœ…\|âŒ" logs/playbook_*.log
```

### æ•…éšœæ¢å¤

- **è‡ªåŠ¨é‡è¯•**: æ¸…ç†å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
- **é™çº§æ¸…ç†**: å¸¸è§„æ¸…ç†å¤±è´¥æ—¶å¯åŠ¨ç´§æ€¥æ¸…ç†æ¨¡å¼
- **é”™è¯¯è®°å½•**: è¯¦ç»†è®°å½•æ‰€æœ‰æ¸…ç†é”™è¯¯ä¾›åˆ†æ

## ğŸ”„ æ‰§è¡Œæµç¨‹

### å•ä¸ªScenarioæ‰§è¡Œæµç¨‹

1. **ç³»ç»Ÿå¥åº·æ£€æŸ¥**: éªŒè¯æ‰€æœ‰èŠ‚ç‚¹å’ŒæœåŠ¡çŠ¶æ€
2. **ç¯å¢ƒå‡†å¤‡**: ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼Œå‡†å¤‡æµ‹è¯•ç¯å¢ƒ
3. **ğŸš€ å¹¶å‘æœåŠ¡éƒ¨ç½²**: åŸºäºä¾èµ–å…³ç³»æ™ºèƒ½æ‰¹æ¬¡åŒ–éƒ¨ç½²æœåŠ¡
4. **ç­‰å¾…å°±ç»ª**: ç­‰å¾…æœåŠ¡å®Œå…¨å¯åŠ¨å’Œå¥åº·æ£€æŸ¥é€šè¿‡
5. **æ‰§è¡Œæµ‹è¯•**: è¿è¡ŒAICPåŸºå‡†æµ‹è¯•
6. **ğŸ’¾ æ™ºèƒ½ç»“æœæ”¶é›†**: ä»æµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹æ”¶é›†artifactsï¼Œæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹èŠ‚ç‚¹è‡ªåŠ¨è¯†åˆ«
7. **æœåŠ¡åœæ­¢**: åœæ­¢æ¨ç†æœåŠ¡
8. **ç¯å¢ƒæ¸…ç†**: æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œèµ„æº

### å¤šScenarioæ‰§è¡Œæµç¨‹

å½“æ‰§è¡Œ `--all` æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨scenariosä¹‹é—´è¿›è¡Œå®Œå…¨èµ„æºéš”ç¦»ï¼š

1. **åˆå§‹å¥åº·æ£€æŸ¥**: éªŒè¯ç³»ç»Ÿæ•´ä½“çŠ¶æ€
2. **Scenario Aæ‰§è¡Œ**: æ‰§è¡Œç¬¬ä¸€ä¸ªscenarioçš„å®Œæ•´æµç¨‹
3. **ğŸ§¹ å®Œå…¨èµ„æºæ¸…ç†**: æ¸…ç†SSHè¿æ¥æ± ã€ä¸´æ—¶æ–‡ä»¶ã€å†…å­˜çŠ¶æ€
4. **ğŸ” ç¯å¢ƒéªŒè¯**: éªŒè¯ç¯å¢ƒå·²å®Œå…¨æ¸…ç†å¹²å‡€
5. **Scenario Bæ‰§è¡Œ**: åœ¨çº¯å‡€ç¯å¢ƒä¸­æ‰§è¡Œä¸‹ä¸€ä¸ªscenario
6. **é‡å¤æ­¥éª¤3-5**: ç›´åˆ°æ‰€æœ‰scenariosæ‰§è¡Œå®Œæ¯•
7. **æœ€ç»ˆæ¸…ç†**: æ‰§è¡Œæœ€ç»ˆçš„èµ„æºæ¸…ç†
8. **ç”ŸæˆæŠ¥å‘Š**: æ±‡æ€»æ‰€æœ‰æ•°æ®å¹¶ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š

## ğŸ› ï¸ é«˜çº§åŠŸèƒ½

### åœºæ™¯ç®¡ç†æ¨¡å¼

æ”¯æŒä¸‰ç§åœºæ™¯å‘ç°æ¨¡å¼ï¼š
- **auto**: è‡ªåŠ¨å‘ç°å¹¶æŒ‰ç›®å½•åæ’åº
- **directory**: ä¸¥æ ¼æŒ‰ç›®å½•åæ’åºæ‰§è¡Œ  
- **custom**: å®Œå…¨è‡ªå®šä¹‰æ‰§è¡Œé¡ºåº

### è¿‡æ»¤å’Œæ¡ä»¶æ‰§è¡Œ

```yaml
filters:
  include_tags: ["performance"]
  exclude_tags: ["experimental"]
  only_scenarios: ["baseline_test"]
  skip_scenarios: ["large_model_test"]
```

### å®¹é”™å’Œé‡è¯•

```yaml
inter_scenario:
  wait_between_scenarios: 120
  continue_on_failure: true
  retry_count: 1
```

### Docker Composeç‰ˆæœ¬è‡ªé€‚åº”

ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹èŠ‚ç‚¹ä¸Šçš„Docker Composeç‰ˆæœ¬(V1æˆ–V2)å¹¶é€‚é…ç›¸åº”çš„å‘½ä»¤æ ¼å¼ï¼š
```bash
# è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨ç›¸åº”ç‰ˆæœ¬
# V1: docker-compose -f file.yml up -d
# V2: docker compose -f file.yml up -d
```

### ğŸš€ å¹¶å‘éƒ¨ç½²ç³»ç»Ÿ

Playbook æ”¯æŒåŸºäºä¾èµ–å…³ç³»çš„æ™ºèƒ½å¹¶å‘éƒ¨ç½²ï¼Œæ˜¾è‘—å‡å°‘æ€»ä½“éƒ¨ç½²æ—¶é—´ï¼š

#### æ ¸å¿ƒç‰¹æ€§

- **ğŸ¯ æ‰¹æ¬¡åŒ–éƒ¨ç½²**: åŸºäºæœåŠ¡ä¾èµ–å…³ç³»è‡ªåŠ¨åˆ†æ‰¹ï¼Œç¡®ä¿ä¾èµ–é¡ºåºæ­£ç¡®
- **âš¡ æ‰¹æ¬¡å†…å¹¶å‘**: åŒä¸€æ‰¹æ¬¡å†…çš„æœåŠ¡å¯ä»¥å¹¶å‘éƒ¨ç½²ï¼Œæé«˜éƒ¨ç½²æ•ˆç‡
- **ğŸ”„ æ™ºèƒ½é‡è¯•**: åªé‡è¯•å¤±è´¥çš„æœåŠ¡ï¼Œä¸å½±å“å·²æˆåŠŸçš„æœåŠ¡
- **ğŸ“Š å®æ—¶ç›‘æ§**: æä¾›è¯¦ç»†çš„éƒ¨ç½²è¿›åº¦å’ŒçŠ¶æ€è·Ÿè¸ª

#### ä¾èµ–å…³ç³»å¤„ç†

ç³»ç»Ÿä½¿ç”¨æ‹“æ‰‘æ’åºï¼ˆKahnç®—æ³•ï¼‰è‡ªåŠ¨è®¡ç®—éƒ¨ç½²æ‰¹æ¬¡ï¼š

```yaml
# metadata.yml ä¸­å®šä¹‰æœåŠ¡ä¾èµ–
deployment:
  services:
    # Batch 1: åŸºç¡€æœåŠ¡ï¼ˆæ— ä¾èµ–ï¼‰
    - name: "redis"
      depends_on: []
    - name: "mysql"
      depends_on: []

    # Batch 2: åº”ç”¨æœåŠ¡ï¼ˆä¾èµ–åŸºç¡€æœåŠ¡ï¼‰
    - name: "user-service"
      depends_on: ["redis", "mysql"]
    - name: "order-service"
      depends_on: ["redis", "mysql"]

    # Batch 3: ç½‘å…³æœåŠ¡ï¼ˆä¾èµ–åº”ç”¨æœåŠ¡ï¼‰
    - name: "api-gateway"
      depends_on: ["user-service", "order-service"]
```

#### å¹¶å‘é…ç½®

åœ¨ `config/scenarios.yaml` ä¸­é…ç½®å¹¶å‘è¡Œä¸ºï¼š

```yaml
execution_config:
  concurrent_deployment:
    # æ‰¹æ¬¡å†…æœ€å¤§å¹¶å‘æœåŠ¡æ•°ï¼ˆå»ºè®®3-8ï¼‰
    max_concurrent_services: 5

    # å¥åº·æ£€æŸ¥æœ€å¤§å¹¶å‘æ•°ï¼ˆå»ºè®®5-15ï¼‰
    max_concurrent_health_checks: 10

    # éƒ¨ç½²è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œå»ºè®®300-900ï¼‰
    deployment_timeout: 600

    # å¥åº·æ£€æŸ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œå»ºè®®120-600ï¼‰
    health_check_timeout: 300

  retry_strategy:
    # æœåŠ¡çº§é‡è¯•æ¬¡æ•°ï¼ˆå»ºè®®1-3ï¼‰
    service_level_retries: 2

    # é‡è¯•é—´éš”æ—¶é—´ï¼ˆç§’ï¼Œå»ºè®®15-60ï¼‰
    retry_delay: 30

    # åªé‡è¯•å¤±è´¥çš„æœåŠ¡ï¼ˆæ¨èå¼€å¯ï¼‰
    retry_only_failed: true
```

#### æ€§èƒ½ä¼˜åŠ¿

ä¸ä¼ ç»Ÿä¸²è¡Œéƒ¨ç½²ç›¸æ¯”ï¼š

- **ğŸš€ éƒ¨ç½²æ—¶é—´**: èŠ‚çœ30%-70%çš„æ€»éƒ¨ç½²æ—¶é—´
- **âš¡ å¹¶å‘æ•ˆç‡**: æ‰¹æ¬¡å†…æœåŠ¡å¹¶å‘å¯åŠ¨ï¼Œå……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æº
- **ğŸ”§ æ™ºèƒ½é‡è¯•**: åªé‡è¯•å¤±è´¥æœåŠ¡ï¼ŒèŠ‚çœ50%-80%é‡è¯•æ—¶é—´
- **ğŸ“ˆ æ‰©å±•æ€§**: å¯é…ç½®å¹¶å‘åº¦ï¼Œé€‚åº”ä¸åŒç¡¬ä»¶ç¯å¢ƒ

#### å·¥ä½œåŸç†

```
ä¼ ç»Ÿä¸²è¡Œéƒ¨ç½²ï¼š
Service A â†’ Service B â†’ Service C â†’ Service D
æ€»æ—¶é—´ = A + B + C + D = 20åˆ†é’Ÿ

å¹¶å‘æ‰¹æ¬¡éƒ¨ç½²ï¼š
Batch 1: [Service A, Service B] (å¹¶å‘) â†’ 8åˆ†é’Ÿ
Batch 2: [Service C, Service D] (å¹¶å‘) â†’ 6åˆ†é’Ÿ
æ€»æ—¶é—´ = max(A,B) + max(C,D) = 14åˆ†é’Ÿ (èŠ‚çœ30%)
```

#### è°ƒä¼˜å»ºè®®

**é«˜æ€§èƒ½ç¯å¢ƒ** (å……è¶³CPU/å†…å­˜):
```yaml
max_concurrent_services: 8-12
max_concurrent_health_checks: 15-20
```

**æ™®é€šç¯å¢ƒ** (å¹³è¡¡æ€§èƒ½å’Œç¨³å®šæ€§):
```yaml
max_concurrent_services: 3-6
max_concurrent_health_checks: 8-12
```

**å—é™ç¯å¢ƒ** (é¿å…èµ„æºç«äº‰):
```yaml
max_concurrent_services: 1-2
max_concurrent_health_checks: 3-5
```

### å…¶ä»–æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§

- **è¿æ¥æ± ç®¡ç†**: æ™ºèƒ½SSHè¿æ¥å¤ç”¨ï¼Œå‡å°‘è¿æ¥å¼€é”€
- **å¹¶è¡Œå¥åº·æ£€æŸ¥**: åŒæ—¶æ£€æŸ¥å¤šä¸ªèŠ‚ç‚¹çŠ¶æ€
- **æ™ºèƒ½é‡è¯•**: åŸºäºé”™è¯¯ç±»å‹çš„å·®å¼‚åŒ–é‡è¯•ç­–ç•¥
- **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜ç‰ˆæœ¬æ£€æµ‹å’Œé…ç½®éªŒè¯ç»“æœ

### è‡ªåŠ¨æ¢å¤

å¥åº·æ£€æŸ¥å™¨æ”¯æŒè‡ªåŠ¨æ¢å¤æœºåˆ¶ï¼Œå¯ä»¥åœ¨æ£€æµ‹åˆ°é—®é¢˜æ—¶è‡ªåŠ¨å°è¯•ä¿®å¤ï¼š
- DockeræœåŠ¡è‡ªåŠ¨é‡å¯
- SSHè¿æ¥è‡ªåŠ¨é‡è¿
- å¤±è´¥èŠ‚ç‚¹çš„éš”ç¦»å’Œæ¢å¤

## ğŸ“‹ æœ€ä½³å®è·µ

### 1. åœºæ™¯ç®¡ç†
- **å‘½åè§„èŒƒ**: ä½¿ç”¨æ•°å­—å‰ç¼€æ§åˆ¶æ‰§è¡Œé¡ºåºï¼ˆå¦‚ `001_baseline`ï¼‰
- **ç›®å½•ç»“æ„**: ä¿æŒåœºæ™¯ç›®å½•ç»“æ„çš„ä¸€è‡´æ€§
- **èµ„æºè§„åˆ’**: åœ¨metadata.yamlä¸­æ˜ç¡®èµ„æºéœ€æ±‚

### 2. é…ç½®ç®¡ç†
- **ç¯å¢ƒå˜é‡**: ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯
- **ä¸‰å±‚é…ç½®**: å……åˆ†åˆ©ç”¨ä¸‰å±‚é…ç½®ç³»ç»Ÿçš„ä¼˜åŠ¿
  - åœºæ™¯ç‰¹å®šé…ç½®æ”¾åœ¨ `metadata.yaml`
  - é¡¹ç›®çº§é…ç½®æ”¾åœ¨ `config/defaults.yaml`
  - è®©ç³»ç»Ÿé»˜è®¤å€¼å¤„ç†åŸºç¡€é…ç½®
- **é…ç½®éªŒè¯**: ä½¿ç”¨ `./playbook.py validate` éªŒè¯é…ç½®æ–‡ä»¶

### 3. æµ‹è¯•è„šæœ¬ç¼–å†™
- **ç¯å¢ƒå˜é‡ä½¿ç”¨**: ä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿæä¾›çš„ç¯å¢ƒå˜é‡
  ```bash
  # æ¨èï¼šä½¿ç”¨ç¯å¢ƒå˜é‡
  mkdir -p "$SCENARIO_RESULT_PATH"

  # ä¸æ¨èï¼šç¡¬ç¼–ç è·¯å¾„
  mkdir -p "/opt/benchmark/results"
  ```
- **é”™è¯¯å¤„ç†**: åœ¨è„šæœ¬å¼€å§‹æ·»åŠ  `set -e` ç¡®ä¿é”™è¯¯æ—¶åœæ­¢
- **æ—¥å¿—è®°å½•**: ä½¿ç”¨æœ‰æ„ä¹‰çš„æ—¥å¿—è¾“å‡ºï¼Œä¾¿äºè°ƒè¯•

### 4. æ€§èƒ½ä¼˜åŒ–
- **å¹¶å‘é…ç½®**: æ ¹æ®ç¡¬ä»¶èµ„æºè°ƒæ•´ `max_concurrent_services`
- **ä¼ è¾“æ–¹å¼**: åˆ©ç”¨SCPä¼ è¾“çš„æ€§èƒ½ä¼˜åŠ¿ï¼ˆè‡ªåŠ¨å¯ç”¨ï¼‰
- **è¶…æ—¶è®¾ç½®**: æ ¹æ®å®é™…æµ‹è¯•å¤æ‚åº¦è°ƒæ•´è¶…æ—¶æ—¶é—´

### 5. è¿ç»´ç®¡ç†
- **é”™è¯¯å¤„ç†**: å¯ç”¨continue_on_failureè¿›è¡Œæ‰¹é‡æµ‹è¯•
- **ç»“æœç®¡ç†**: å®šæœŸæ¸…ç†æ—§çš„æµ‹è¯•ç»“æœï¼Œé¿å…ç£ç›˜ç©ºé—´ä¸è¶³
- **ç›‘æ§æ—¥å¿—**: ä½¿ç”¨è¯¦ç»†æ—¥å¿—æ¨¡å¼è¿›è¡Œé—®é¢˜æ’æŸ¥
- **å¥åº·æ£€æŸ¥**: å®šæœŸè¿è¡Œ `./playbook.py health` æ£€æŸ¥ç³»ç»ŸçŠ¶æ€

### 6. Artifactsæ”¶é›†è°ƒä¼˜
- **ç½‘ç»œç¯å¢ƒä¼˜åŒ–**:
  ```yaml
  # é«˜å»¶è¿Ÿç½‘ç»œç¯å¢ƒ
  artifacts_collection:
    remote_node:
      ssh_retry_count: 5        # å¢åŠ é‡è¯•æ¬¡æ•°
      transfer_timeout: 600     # å»¶é•¿è¶…æ—¶æ—¶é—´
      integrity_check: false    # è·³è¿‡MD5æ ¡éªŒèŠ‚çœæ—¶é—´
  ```
- **æ€§èƒ½ä¼˜åŒ–é…ç½®**:
  ```yaml
  # é«˜æ€§èƒ½ç¯å¢ƒï¼ˆç¨³å®šç½‘ç»œï¼‰
  artifacts_collection:
    remote_node:
      ssh_retry_count: 2        # å‡å°‘é‡è¯•æ¬¡æ•°
      transfer_timeout: 120     # ç¼©çŸ­è¶…æ—¶æ—¶é—´
      integrity_check: true     # å¯ç”¨å®Œæ•´æ€§æ ¡éªŒ
  ```
- **å­˜å‚¨ç©ºé—´ç®¡ç†**:
  - å¤§æ–‡ä»¶åœºæ™¯å»ºè®®ä½¿ç”¨ `collection_mode: "basic"` ä»…æ”¶é›†å¿…è¦artifacts
  - è®¾ç½®è‡ªåŠ¨æ¸…ç†ç­–ç•¥: `./playbook.py results --cleanup --days 7`
  - ç›‘æ§ç£ç›˜ä½¿ç”¨: ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æŸ¥å‰©ä½™ç©ºé—´å¹¶é¢„è­¦

## ğŸ› æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **SSHè¿æ¥å¤±è´¥**: æ£€æŸ¥èŠ‚ç‚¹é…ç½®å’Œç½‘ç»œè¿é€šæ€§
2. **DockeræœåŠ¡å¯åŠ¨å¤±è´¥**: éªŒè¯docker-composeæ–‡ä»¶å’Œé•œåƒ
3. **æµ‹è¯•æ‰§è¡Œè¶…æ—¶**: è°ƒæ•´è¶…æ—¶é…ç½®æˆ–æ£€æŸ¥èµ„æºä½¿ç”¨æƒ…å†µ
4. **ç»“æœæ”¶é›†å¤±è´¥**: æ£€æŸ¥ç»“æœè·¯å¾„å’Œæƒé™è®¾ç½®
5. **"Garbage packet received"é”™è¯¯**: å·²é€šè¿‡èµ„æºéš”ç¦»ç³»ç»Ÿè§£å†³ï¼Œå¦‚ä»å‡ºç°è¯·æ£€æŸ¥ç½‘ç»œç¯å¢ƒ
6. **Scenarioé—´çŠ¶æ€æ±¡æŸ“**: ç³»ç»Ÿå·²å®ç°å®Œå…¨éš”ç¦»ï¼Œæ¯ä¸ªscenarioåœ¨ç‹¬ç«‹ç¯å¢ƒä¸­è¿è¡Œ
7. **èµ„æºæ¸…ç†å¤±è´¥**: ç³»ç»Ÿä¼šè‡ªåŠ¨å¯åŠ¨ç´§æ€¥æ¸…ç†ï¼ŒæŸ¥çœ‹æ—¥å¿—äº†è§£è¯¦æƒ…

### Artifactsæ”¶é›†ç›¸å…³é—®é¢˜

8. **Artifactsæ–‡ä»¶æœªæ‰¾åˆ°**:
   - æ£€æŸ¥ `test_execution.node` é…ç½®æ˜¯å¦æ­£ç¡®æŒ‡å®šäº†æµ‹è¯•æ‰§è¡ŒèŠ‚ç‚¹
   - éªŒè¯ `result_paths` ä¸­çš„æ–‡ä»¶è·¯å¾„æ˜¯å¦å­˜åœ¨äºæŒ‡å®šèŠ‚ç‚¹ä¸Š
   - æŸ¥çœ‹æ—¥å¿—ä¸­çš„ "Remote artifact not found" æˆ– "Local artifact not found" ä¿¡æ¯

9. **æ–‡ä»¶ä¼ è¾“å¤±è´¥**:
   - **æœ¬åœ°èŠ‚ç‚¹**: æ£€æŸ¥ç›®æ ‡ç›®å½•å†™æƒé™å’Œç£ç›˜ç©ºé—´
   - **è¿œç¨‹èŠ‚ç‚¹**: æ£€æŸ¥SSHè¿æ¥å’ŒSCPä¼ è¾“æƒé™
   - æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—: `grep "integrity check failed\|download failed" logs/playbook_*.log`

10. **æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒå¤±è´¥**:
    - æ£€æŸ¥ç½‘ç»œç¨³å®šæ€§ï¼Œæ–‡ä»¶ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½è¢«ä¸­æ–­
    - å¯¹äºå¤§æ–‡ä»¶(>10MB)ï¼Œç³»ç»Ÿä»…æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼Œå°æ–‡ä»¶ä¼šè¿›è¡ŒMD5æ ¡éªŒ
    - é‡æ–°è¿è¡Œåœºæ™¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¯•å¤±è´¥çš„ä¼ è¾“

11. **ä»é”™è¯¯èŠ‚ç‚¹æ”¶é›†artifacts**:
    ```bash
    # æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†åºŸå¼ƒçš„API
    grep "collect_artifacts_from_nodes" logs/playbook_*.log

    # ç¡®è®¤ä½¿ç”¨æ–°çš„API
    grep "collect_artifacts_from_test_node" logs/playbook_*.log
    ```

12. **æ”¶é›†æ¨¡å¼é…ç½®é—®é¢˜**:
    - `basic`: ä»…æ”¶é›†test artifactsï¼Œä¸æ”¶é›†æœåŠ¡æ—¥å¿—
    - `standard`: æ”¶é›†test artifacts + DockeræœåŠ¡æ—¥å¿—
    - `comprehensive`: æ”¶é›†æ‰€æœ‰å†…å®¹ + ç³»ç»Ÿæ—¥å¿—
    - æ£€æŸ¥åœºæ™¯çš„ `collection_mode` é…ç½®æ˜¯å¦ç¬¦åˆé¢„æœŸ

### è°ƒè¯•å‘½ä»¤

```bash
# è¯¦ç»†æ¨¡å¼è¿è¡Œ
./playbook.py --verbose --log-level DEBUG status

# éªŒè¯é…ç½®
./playbook.py validate

# å¥åº·æ£€æŸ¥
./playbook.py health

# å¹²è¿è¡Œ - éªŒè¯é…ç½®ä½†ä¸æ‰§è¡Œ
./playbook.py run --dry-run

# è¿è¡Œå•ä¸ªåœºæ™¯å¹¶è¯¦ç»†è¾“å‡º
./playbook.py --verbose run baseline_test

# æŸ¥çœ‹ç»“æœçš„ä¸åŒæ ¼å¼
./playbook.py results --format json
./playbook.py results --format yaml
./playbook.py results --format table
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¹¶å‘æ§åˆ¶**: æ ¹æ®ç¡¬ä»¶èµ„æºè°ƒæ•´max_concurrency
2. **æ‰¹å¤„ç†**: ä½¿ç”¨åˆé€‚çš„batch_sizeæé«˜ååé‡
3. **å†…å­˜ç®¡ç†**: ç›‘æ§GPUå’Œç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ
4. **ç½‘ç»œä¼˜åŒ–**: ç¡®ä¿èŠ‚ç‚¹é—´ç½‘ç»œå¸¦å®½å……è¶³
5. **å­˜å‚¨IO**: ä½¿ç”¨é«˜æ€§èƒ½å­˜å‚¨å­˜æ”¾æ¨¡å‹å’Œç»“æœæ•°æ®

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ [FAQ](docs/FAQ.md)
2. æœç´¢å·²æœ‰çš„ [Issues](https://github.com/your-org/test_playbook/issues)
3. åˆ›å»ºæ–°çš„ Issue æè¿°æ‚¨çš„é—®é¢˜
4. è”ç³»å¼€å‘å›¢é˜Ÿè·å–æ”¯æŒ

---

ğŸš€ **Happy Testing!** ğŸš€